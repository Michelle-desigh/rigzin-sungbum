<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰æ—ºè«¾å¸ƒå…¨é›†é–±è®€ç³»çµ±</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Tibetan:wght@300;400;500;600;700&family=Noto+Serif+TC:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* ... (æ‚¨çš„é¡è‰²è®Šæ•¸ä¿æŒä¸è®Š) ... */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warm-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --green-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);

            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --shadow-soft: 0 8px 32px rgba(31, 38, 135, 0.37);
            --shadow-hover: 0 15px 35px rgba(31, 38, 135, 0.5);

            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-light: rgba(255, 255, 255, 0.9);
            --tibetan-title-font: 'Noto Sans Tibetan', 'Noto Serif TC', serif;
            --border-radius-main: 16px; /* èª¿æ•´å¾Œçš„åœ“è§’ */
            --border-radius-small: 8px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            display: flex; /* For footer */
            flex-direction: column; /* For footer */
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: url('background_literature.jpg') no-repeat center center; /* å›ºå®šèƒŒæ™¯åœ– */
            background-size: cover;
            /* transition: background 0.8s ease; -- ä¸å†éœ€è¦ï¼Œå› ç‚ºä¸»é¡Œåˆ‡æ›å·²ç§»é™¤ */
        }

        .background-container::before {
            /* ... (ç²’å­æ•ˆæœä¿æŒä¸è®Š) ... */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="40" cy="80" r="1.5" fill="rgba(255,255,255,0.08)"/><circle cx="60" cy="10" r="0.8" fill="rgba(255,255,255,0.06)"/><circle cx="10" cy="60" r="1.2" fill="rgba(255,255,255,0.09)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            animation: float 15s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateX(0) translateY(0); } 25% { transform: translateX(-3px) translateY(-3px); } 50% { transform: translateX(3px) translateY(3px); } 75% { transform: translateX(-2px) translateY(2px); } }


        .glass { background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); box-shadow: var(--shadow-soft); }

        #modeSelectorScreen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; text-align: center; position: relative; z-index: 10; }
        .mode-selector-content {
            /* ... (å¯¬åº¦ä¿æŒï¼Œåœ“è§’ä¿®æ”¹) ... */
            max-width: 850px; width: 90%;
            border-radius: var(--border-radius-main); /* åœ“è§’èª¿æ•´ */
            padding: 3rem 2.5rem; /* ç¨å¾®èª¿æ•´ padding */
        }
        /* ... (fadeInUp å‹•ç•«ä¿æŒä¸è®Š) ... */

        .main-title { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .tibetan-subtitle { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .english-subtitle { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .mode-buttons { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .mode-button {
            /* ... (padding å’Œå­—é«”å¤§å°ä¿æŒä¸è®Š) ... */
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
        }
        /* ... (mode-button hover å’Œ ::before ä¿æŒä¸è®Š) ... */

        /* .theme-switcher å°‡è¢«ç§»é™¤ */

        #appContainer {
            display: none; width: 100%; min-height: 100vh; opacity: 0; animation: fadeIn 0.6s ease-out forwards;
            flex-grow: 1; /* For footer */
        }
        /* ... (fadeIn å‹•ç•«å’Œ app-active ä¿æŒä¸è®Š) ... */

        .sidebar { /* ... (åœ“è§’èª¿æ•´ï¼Œå…¶ä»–ä¸è®Š) ... */
             border-top-right-radius: var(--border-radius-main);
             border-bottom-right-radius: var(--border-radius-main);
        }
        /* ... (sidebar-header, course-menu ç­‰å´é‚Šæ¬„æ¨£å¼ä¿æŒä¸è®Šï¼Œå¯æŒ‰éœ€èª¿æ•´åœ“è§’) ... */
        .category-header { border-radius: var(--border-radius-small); margin: 0 0.5rem;}
        .course-item { border-radius: var(--border-radius-small); margin: 0.2rem 0.5rem;}


        .main-content { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }

        .top-bar { /* ... (åœ“è§’èª¿æ•´ï¼Œå…¶ä»–ä¸è®Š) ... */
            border-bottom-left-radius: var(--border-radius-main);
            border-bottom-right-radius: var(--border-radius-main);
        }
        .breadcrumb { display: none !important; /* éš±è—éºµåŒ…å±‘å°èˆª */ }
        .user-section { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .modern-btn {
            /* ... (padding å’Œå­—é«”å¤§å°ä¿æŒä¸è®Š) ... */
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
            text-align: center; /* ç¢ºä¿æ–‡å­—ç½®ä¸­ */
        }
        /* ... (modern-btn hover å’Œ ::before ä¿æŒä¸è®Š) ... */

        .container { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .header { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }

        .search-section { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .search-container {
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
        }
        /* ... (search-input, search-icon ä¿æŒä¸è®Š) ... */

        .stats-bar {
            border-radius: var(--border-radius-main); /* åœ“è§’èª¿æ•´ */
        }
        .view-controls { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .view-btn {
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
        }
        /* ... (view-btn.active ä¿æŒä¸è®Š) ... */

        .documents-grid { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .document-card {
            /* ... (padding ä¿æŒä¸è®Š) ... */
            border-radius: var(--border-radius-main); /* åœ“è§’èª¿æ•´ */
            /* å¡ç‰‡å¯¬åº¦èª¿æ•´ - å¯ä»¥é€šé grid-template-columns æˆ– max-width æ§åˆ¶ */
            /* å¦‚æœä½¿ç”¨ grid, repeat(auto-fit, minmax(300px, 1fr)); å¯å˜—è©¦æ¸›å° minmax çš„ç¬¬ä¸€å€‹å€¼ */
        }
        /* ... (document-card::before, hover, title, subtitle ç­‰ä¿æŒä¸è®Š) ... */
        .btn {
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
            justify-content: center; /* æŒ‰éˆ•æ–‡å­—ç½®ä¸­ */
        }
        /* ... (btn-primary, btn-secondary ä¿æŒä¸è®Š) ... */


        .utility-sidebar { /* ... (åœ“è§’èª¿æ•´ï¼Œå…¶ä»–ä¸è®Š) ... */
            border-top-left-radius: var(--border-radius-main);
            border-bottom-left-radius: var(--border-radius-main);
        }
        /* ... (utility-sidebar-header, content, item ç­‰ä¿æŒä¸è®Š) ... */


        @media (max-width: 768px) {
            /* ... (å¤§éƒ¨åˆ†éŸ¿æ‡‰å¼æ¨£å¼ä¿æŒä¸è®Š) ... */
            .mode-selector-content { padding: 2.5rem 1.5rem; }
            .main-title { font-size: 2.5rem; } /* ç¢ºä¿åœ¨å°è¢å¹•ä¹Ÿèƒ½å®¹ç´ */
        }
        /* ... (menu-toggle ä¿æŒä¸è®Š) ... */

        /* ... (admin-only, reader-only ä¿æŒä¸è®Š) ... */

        .modal { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .modal-content {
            /* ... (å¯¬åº¦å’Œé«˜åº¦èª¿æ•´å·²åœ¨ä¹‹å‰å®Œæˆ) ... */
            border-radius: var(--border-radius-main); /* åœ“è§’èª¿æ•´ */
        }
        .modal-header { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        /* ... (modalTitleEl, modalTitleTibetanEl æ¨£å¼ä¿æŒä¸è®Š) ... */
        .modal-body { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .modal-body h3 { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .close-btn { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        /* ... (text-content-base, language-content, å„èªè¨€ text class, colophon ä¿æŒä¸è®Š) ... */
        .language-switcher button {
             border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
        }
        /* ... (language-separator ä¿æŒä¸è®Š) ... */

        /* ... (message æç¤ºæ¨£å¼ä¿æŒä¸è®Š) ... */

        /* è¡¨å–®æ¨£å¼ */
        .form-group { /* ... (æ¨£å¼ä¿æŒä¸è®Š) ... */ }
        .form-control, .form-select, .form-textarea {
            border-radius: var(--border-radius-small); /* åœ“è§’èª¿æ•´ */
        }
        /* ... (form-textarea, focus æ¨£å¼ä¿æŒä¸è®Š) ... */
        #adminLoginModalEl .modal-content {
            max-width: 400px; /* ç¸®å°ç™»å…¥å½ˆçª— */
        }
        #articleFormModalEl .modal-content {
             max-width: min(90vw, 1000px); /* ç·¨è¼¯å½ˆçª—ç¨å¾®ç¸®å° */
        }

        /* Footer styles */
        footer {
            background-color: rgba(0, 0, 0, 0.7); /* æ·±è‰²èƒŒæ™¯ */
            color: var(--text-light);
            padding: 1.5rem 1rem;
            text-align: center;
            border-top: 1px solid var(--glass-border);
            margin-top: auto; /* Push to bottom in flex container */
            font-size: 0.8rem; /* ç¸®å°å­—é«” */
        }
        .social-links a {
            color: var(--text-light);
            margin: 0 0.5rem;
            text-decoration: none;
            font-size: 1.2rem; /* åœ–æ¨™å¤§å° */
            transition: color 0.3s;
        }
        .social-links a:hover {
            color: var(--accent-gradient); /* é€™è£¡ç”¨ä¸€å€‹å·²æœ‰çš„æ¼¸è®Šè‰²ï¼Œæˆ–è€…è‡ªå®šç¾©é¡è‰² */
        }
        .copyright {
            margin-top: 0.8rem;
            font-size: 0.75rem; /* é€²ä¸€æ­¥ç¸®å°ç‰ˆæ¬Šå­—é«” */
        }

    </style>
</head>
<body>
    <div class="background-container" id="backgroundContainer"></div>

    <div id="modeSelectorScreen">
        <div class="mode-selector-content">
            <h1 class="main-title">æ‰æ—ºè«¾å¸ƒå…¨é›†é–±è®€ç³»çµ±</h1>
            <p class="tibetan-subtitle">à¼„à¼…à¼ à¼à½šà½ºà¼‹à½‘à½–à½„à¼‹à½“à½¼à½¢à¼‹à½–à½´à½ à½²à¼‹à½‚à½¦à½´à½„à¼‹à½ à½–à½´à½˜à¼‹à½€à¾³à½¼à½‚à¼‹à½¦à¾Ÿà½ºà½‚à½¦à¼</p>
            <p class="english-subtitle">Tsewang Norbu Complete Works Reading System</p>
            <div class="mode-buttons">
                <button class="mode-button" onclick="enterMode('read')">ğŸ“– é€²å…¥é–±è®€æ¨¡å¼</button>
                <button class="mode-button" onclick="enterMode('edit')">ğŸ” é€²å…¥ç·¨è¼¯æ¨¡å¼</button>
            </div>
            <!-- Theme switcher is removed -->
        </div>
    </div>

    <div id="appContainer">
        <aside class="sidebar" id="sidebar">
             <!-- Sidebar content remains the same -->
            <div class="sidebar-header">
                <h2 class="sidebar-title">èª²ç¨‹ç›®éŒ„</h2>
                <p class="sidebar-subtitle">à½¦à¾³à½¼à½–à¼‹à½šà½“à¼‹à½‚à¾±à½²à¼‹à½‘à½€à½¢à¼‹à½†à½‚</p>
            </div>
            <nav class="course-menu" id="courseMenuContainer"></nav>
        </aside>

        <main class="main-content" id="mainContentArea">
            <div class="top-bar">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="menu-toggle" id="leftSidebarToggle" onclick="toggleSidebar('sidebar')">â˜°</button>
                    <div class="breadcrumb" id="breadcrumbPath"> <!-- This will be hidden by CSS -->
                        <span>ğŸ  é¦–é </span>
                        <span>></span>
                        <span id="currentDocCategory">è‡ªå‚³</span>
                        <span>></span>
                        <span id="currentDocTitle">åª½å««ç§˜å¯†æ¥­ä¹‹æ˜é»</span>
                    </div>
                </div>
                <div class="user-section" id="userSectionEl">
                    <!-- Buttons dynamically added by JS -->
                </div>
            </div>

            <div class="container">
                <!-- Main content (header, search, grid) remains the same structurally -->
                <header class="header">
                    <h1>æ‰æ—ºè«¾å¸ƒå…¨é›†é–±è®€ç³»çµ±</h1>
                    <p>à½šà½ºà¼‹à½‘à½–à½„à¼‹à½“à½¼à½¢à¼‹à½–à½´à½ à½²à¼‹à½‚à½¦à½´à½„à¼‹à½ à½–à½´à½˜à¼‹à½€à¾³à½¼à½‚à¼‹à½¦à¾Ÿà½ºà½‚à½¦à¼ | Tsewang Norbu Complete Works Reading System</p>
                </header>

                <div class="search-section">
                    <div class="search-container">
                        <span class="search-icon">ğŸ”</span>
                        <input type="text" class="search-input" placeholder="æœå°‹æ–‡ç»æ¨™é¡Œã€å…§å®¹æˆ–ä½œè€…..." id="searchInputEl">
                    </div>
                </div>

                <div class="stats-bar">
                    <div class="view-controls">
                        <button class="view-btn active" id="gridViewBtn">ğŸ“‡ å¡ç‰‡æª¢è¦–</button>
                        <button class="view-btn" id="listViewBtn">ğŸ“‹ æ¸…å–®æª¢è¦–</button>
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        ç¸½è¨ˆ <strong id="totalCountEl">0</strong> éƒ¨æ–‡ç»
                    </div>
                </div>

                <div class="documents-grid" id="documentsGridEl">
                    <!-- æ–‡ç»å¡ç‰‡å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </main>

        <aside class="utility-sidebar reader-only" id="utilitySidebarEl">
             <!-- Utility sidebar content remains the same, symbols will be updated in JS for buttons -->
            <div class="utility-sidebar-header">
                <h3 class="utility-sidebar-title">å·¥å…·é¸å–®</h3>
            </div>
            <div class="utility-sidebar-content">
                <div class="utility-item" onclick="showFavorites()">
                    <span class="utility-item-icon">â™¥</span> å·²æ”¶è—æ–‡ç« 
                </div>
                <div id="favoritesListContainerEl" style="display:none;">
                    <p>æš«ç„¡æ”¶è—ã€‚</p>
                </div>
                <div class="utility-item" onclick="showUtilityModal('reportErrorModal', 'å›å ±éŒ¯å­—')">
                    <span class="utility-item-icon">âœ‰ï¸</span> å›å ±éŒ¯å­—
                </div>
                <div class="utility-item" onclick="showUtilityModal('donateModal', 'è­·æŒè´ŠåŠ©')">
                    <span class="utility-item-icon">ğŸ’°</span> è­·æŒè´ŠåŠ©
                </div>
            </div>
        </aside>
    </div>

    <!-- Document Modal -->
    <div class="modal" id="documentModalEl">
        <!-- Structure remains the same, CSS handles sizing and border-radius -->
        <div class="modal-content">
            <div class="modal-header">
                <div style="width: calc(100% - 60px); display: flex; flex-direction: column;">
                    <h2 id="modalTitleEl">æ–‡ç»æ¨™é¡Œ</h2>
                    <div id="modalTitleTibetanEl" class="modal-title-tibetan">è—æ–‡æ¨™é¡Œå‰¯æ¨™</div>
                </div>
                <button class="close-btn" onclick="closeModal('documentModalEl')">Ã—</button>
            </div>
            <div class="language-switcher" id="languageSwitcherControls">
                <button onclick="showLanguage('bo')" data-lang="bo">è—æ–‡</button>
                <button onclick="showLanguage('zh')" data-lang="zh">ä¸­æ–‡</button>
                <button onclick="showLanguage('en')" data-lang="en">English</button>
                <button onclick="showLanguage('bo-zh')" data-lang="bo-zh">è—ä¸­å°ç…§</button>
            </div>
            <div class="modal-body text-content-base" id="modalBodyEl">
                <div id="modalTibetanContentEl" class="language-content tibetan-text"></div>
                <hr class="language-separator">
                <div id="modalChineseContentEl" class="language-content chinese-text"></div>
                <hr class="language-separator">
                <div id="modalEnglishContentEl" class="language-content english-text"></div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal" id="adminLoginModalEl">
        <div class="modal-content"> <!-- CSS will make this smaller -->
            <div class="modal-header">
                <h2>ğŸ”’ ç®¡ç†å“¡ç™»å…¥</h2>
                <button class="close-btn" onclick="closeModal('adminLoginModalEl'); showModeSelectorScreen();">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="adminLoginFormEl">
                    <div class="form-group">
                        <label for="adminUsername">ç”¨æˆ¶å</label>
                        <input type="text" id="adminUsername" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">å¯†ç¢¼</label>
                        <input type="password" id="adminPassword" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">ç™»å…¥</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Article Form Modal -->
    <div class="modal" id="articleFormModalEl">
        <div class="modal-content"> <!-- CSS will slightly shrink this -->
            <div class="modal-header">
                <h2 id="articleFormModalTitleEl">ğŸ“ æ–°å¢/ç·¨è¼¯æ–‡ç»</h2>
                <button class="close-btn" onclick="closeModal('articleFormModalEl')">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="articleFormEl">
                    <!-- Form fields remain the same -->
                    <input type="hidden" id="articleId">
                    <div class="form-group">
                        <label for="articleTibetanTitle">è—æ–‡æ¨™é¡Œ</label>
                        <input type="text" id="articleTibetanTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="articleChineseTitle">ä¸­æ–‡æ¨™é¡Œ</label>
                        <input type="text" id="articleChineseTitle" class="form-control" required>
                    </div>
                     <div class="form-group">
                        <label for="articleEnglishTitle">è‹±æ–‡æ¨™é¡Œ (é¸å¡«)</label>
                        <input type="text" id="articleEnglishTitle" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="articleAuthor">ä½œè€…</label>
                        <input type="text" id="articleAuthor" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="articleCategory">åˆ†é¡</label>
                        <input type="text" id="articleCategory" class="form-control" placeholder="ä¾‹å¦‚ï¼šç¥ˆè«‹æ–‡ã€è‡ªå‚³" required>
                    </div>
                    <div class="form-group">
                        <label for="articleTags">æ¨™ç±¤ (é€—è™Ÿåˆ†éš”)</label>
                        <input type="text" id="articleTags" class="form-control" placeholder="ä¾‹å¦‚ï¼šé•·å£½, é‡‘å‰›çµ">
                    </div>
                    <div class="form-group">
                        <label for="articleContentTibetan">è—æ–‡å…§å®¹</label>
                        <textarea id="articleContentTibetan" class="form-textarea" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="articleContentChinese">ä¸­æ–‡å…§å®¹</label>
                        <textarea id="articleContentChinese" class="form-textarea" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="articleContentEnglish">è‹±æ–‡å…§å®¹ (é¸å¡«)</label>
                        <textarea id="articleContentEnglish" class="form-textarea"></textarea>
                    </div>
                    <div class="form-group">
                        <label>å¯æä¾›èªè¨€ (å‹¾é¸)</label>
                        <div>
                            <input type="checkbox" id="langBo" value="bo" checked> <label for="langBo" style="display:inline; margin-right:10px;">è—æ–‡</label>
                            <input type="checkbox" id="langZh" value="zh" checked> <label for="langZh" style="display:inline; margin-right:10px;">ä¸­æ–‡</label>
                            <input type="checkbox" id="langEn" value="en"> <label for="langEn" style="display:inline;">è‹±æ–‡</label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">å„²å­˜æ–‡ç»</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Generic Utility Modal for About, Editor's Note, Resources -->
    <div class="modal" id="infoModalEl">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="infoModalTitleEl">è³‡è¨Š</h2>
                <button class="close-btn" onclick="closeModal('infoModalEl')">Ã—</button>
            </div>
            <div class="modal-body" id="infoModalBodyEl" style="white-space: pre-wrap; line-height: 1.7; color: var(--text-light);">
                <!-- Content dynamically inserted by JS -->
            </div>
        </div>
    </div>


    <div id="messageAreaEl"></div>

    <footer>
        <div class="social-links">
            <!-- Replace # with your actual links -->
            <a href="#" target="_blank" title="Facebook">FB</a>
            <a href="#" target="_blank" title="Twitter">TW</a>
            <a href="#" target="_blank" title="Instagram">IG</a>
            <a href="#" target="_blank" title="YouTube">YT</a>
            <a href="#" target="_blank" title="LinkedIn">LI</a>
        </div>
        <div class="copyright">
            å™¶é™€ä»çåƒå¯¶ Â© 2025 æ‰æ—ºè«¾å¸ƒå…¨é›† All Rights Reserved
        </div>
    </footer>

    <script>
        // --- DATA (Sample) ---
        // ... (Your initialDocuments data structure remains the same, ensure ContentEnglish class is "english-text")
        let documentsData = [];
        const initialDocuments = [
            {
                id: 'history_005',
                tibetanTitle: 'à¼„à¼…à¼ à¼à½–à½´à¼‹à½¦à¾Ÿà½¼à½“à¼‹à½à¼‹à½†à½ºà½¦à¼‹à½˜à½›à½‘à¼‹à½”à½ à½²à¼‹à½†à½¼à½¦à¼‹à½ à½–à¾±à½´à½„à¼‹à½¢à½²à½“à¼‹à½”à½¼à¼‹à½†à½ºà½ à½²à¼‹à½˜à½›à½¼à½‘à¼‹à½£à½¦à¼ à½‚à¼‹à½”à¼‹à½ à½›à½²à½“à¼‹à½”à¼‹à½šà½ºà¼‹à½‘à½–à½„à¼‹à½“à½¼à½¢à¼‹à½–à½´à½¦à¼‹à½‰à½ºà¼‹à½–à½¢à¼‹à½–à½à½´à½¦à¼‹à½”à¼‹à½–à½à½´à½‚à½¦à¼‹à½¦à½¼à¼ à¼',
                chineseTitle: 'å¸ƒæ•¦å¤§å¸«æ‰€æ’°ä½›æ³•æºæµå¯¶è—éŒ„ä¹‹æŒæ˜æ‰æ—ºè«¾å¸ƒç¯€éŒ„æ–‡',
                englishTitle: 'From the Treasury of Religious History by Buton Rinchen Drub Compiled by the VidyÄdhara Tsewang Norbu',
                author: 'æ‰æ—ºè«¾å¸ƒ',
                category: 'æ­·å²',
                tags: ["ä½›æ³•æºæµ", "å¸ƒæ•¦å¤§å¸«", "Buton"],
                ContentTibetan: `<p class="tibetan-text">à¼ˆ à½¨à½¼à½¾à¼‹à½¦à¾­à½±à½¦à¾Ÿà½²à¼ ... (å®Œæ•´è—æ–‡å…§å®¹) ... à¼à½¦à½¢à¾¦à¼‹à½˜à½„à¾’à¼‹à½£à½¾à¼</p>`,
                ContentChinese: `<p class="chinese-text">å—¡å¨‘å¸<b>ç«Šèè¥¿è—ç‹çµ±ä¹‹å§‹æœ«ï¼Œ... (å®Œæ•´ä¸­æ–‡å…§å®¹) ... è–©å“‡ èŠ’å˜æœ—ï¼ã€‚</p>`,
                ContentEnglish: `<p class="english-text"> Oá¹ƒ SvÄsti!<b>According to the lineage of Tibetan kings ... (å®Œæ•´è‹±æ–‡å…§å®¹) ... Sarva Maá¹…galam (May all be auspicious) </p>`,
                status: "published",
                meta: { "words": "N/A", "pages": "N/A", "readTime": "N/A", "preview": "N/A" },
                availableLanguages: ["bo", "zh", "en"],
                createdAt: "2025-05-31T14:08:00Z",
                updatedAt: "2025-05-31T22:18:00Z"
            },
            {
                id: 'aspiration_002',
                tibetanTitle: 'å¦ä¸€ç¯‡ç¥ˆé¡˜æ–‡ (è—)',
                chineseTitle: 'å¦ä¸€ç¯‡ç¥ˆé¡˜æ–‡ (ä¸­)',
                englishTitle: 'Another Aspiration Prayer (Eng)', // Added for consistency
                author: 'ä½šå',
                category: 'ç¥ˆè«‹æ–‡',
                tags: ["è¿´å‘"],
                ContentTibetan: `<p class="tibetan-text">æ­¤ç¥ˆé¡˜æ–‡ä¹‹è—æ–‡å…§å®¹...</p>`,
                ContentChinese: `<p class="chinese-text">æ­¤ç¥ˆé¡˜æ–‡ä¹‹ä¸­æ–‡å…§å®¹...</p>`,
                ContentEnglish: `<p class="english-text">English content of this aspiration...</p>`, // Added
                status: "published",
                meta: { "words": "N/A", "pages": "N/A", "readTime": "N/A", "preview": "N/A" },
                availableLanguages: ["bo", "zh", "en"], // Adjusted
                createdAt: "2023-05-21T11:00:00Z",
                updatedAt: "2023-05-21T11:00:00Z"
            }
        ];


        // --- DOM Elements ---
        // ... (Most DOM element selections remain the same) ...
        const infoModalEl = document.getElementById('infoModalEl');
        const infoModalTitleEl = document.getElementById('infoModalTitleEl');
        const infoModalBodyEl = document.getElementById('infoModalBodyEl');


        // --- Theme Switcher ---
        // function changeTheme(themeName) { ... } // This function is no longer needed as theme switcher is removed.

        // --- Mode Management ---
        // ... (enterMode, showModeSelectorScreen, setupReadModeUI, setupEditModeUI remain largely the same) ...

        // --- Data Management & UI Rendering (Cards) ---
        // ... (updateDocumentMeta, processAllDocumentMeta, loadDocumentsData, renderDocuments remain largely the same) ...
        // In renderDocuments, update favorite button text:
        // actionButtonsHTML = `<button class="btn btn-secondary reader-only" onclick="toggleFavorite('${doc.id}', this)">${isFavorited ? 'â™¥ å·²æ”¶è—' : 'â™¡ åŠ å…¥æ”¶è—'}</button>`;

        // --- Modal Document Viewer ---
        // ... (openDocumentModal, updateLanguageSwitcher, showLanguage, closeModal remain largely the same) ...

        // --- Admin & User Section ---
        // ... (adminLoginFormEl listener, adminLogout remain largely the same) ...
        function updateUserSectionUI() {
            userSectionEl.innerHTML = '';
            const homeButton = document.createElement('button');
            homeButton.className = 'modern-btn';
            homeButton.textContent = 'å›é¦–é ';
            homeButton.onclick = showModeSelectorScreen;
            userSectionEl.appendChild(homeButton);

            const aboutButton = document.createElement('button');
            aboutButton.className = 'modern-btn';
            aboutButton.textContent = 'é—œæ–¼æˆ‘å€‘';
            aboutButton.onclick = () => showInfoModal('é—œæ–¼æˆ‘å€‘', 'é€™æ˜¯é—œæ–¼æˆ‘å€‘çš„å…§å®¹ï¼Œæ‚¨å¯ä»¥æ›¿æ›æˆæ‚¨çš„å¯¦éš›ä»‹ç´¹ã€‚');
            userSectionEl.appendChild(aboutButton);

            const editorsNoteButton = document.createElement('button');
            editorsNoteButton.className = 'modern-btn';
            editorsNoteButton.textContent = 'ç·¨è€…çš„è©±';
            editorsNoteButton.onclick = () => showInfoModalFromFile('ç·¨è€…çš„è©±', 'à½¦à¾’à¾²à½²à½‚à¼‹à½”à¼‹à½”à½¼à½ à½²à¼‹à½‚à½à½˜à¼ç·¨è€…çš„è©±.txt');
            userSectionEl.appendChild(editorsNoteButton);

            const resourcesButton = document.createElement('button');
            resourcesButton.className = 'modern-btn';
            resourcesButton.textContent = 'åƒè€ƒè³‡æº';
            resourcesButton.onclick = () => showInfoModalFromFile('åƒè€ƒè³‡æº', 'åƒè€ƒè³‡æº.txt');
            userSectionEl.appendChild(resourcesButton);

            if (currentMode === 'edit' && isAdminLoggedIn) {
                const addArticleBtn = document.createElement('button');
                addArticleBtn.className = 'modern-btn admin-only';
                addArticleBtn.innerHTML = 'âœ¨ æ–°å¢æ–‡ç»';
                addArticleBtn.onclick = openArticleFormModal;
                userSectionEl.insertBefore(addArticleBtn, userSectionEl.firstChild); // Add to beginning

                const adminInfoDiv = document.createElement('div');
                adminInfoDiv.style.cssText = "color:white; display:flex; align-items:center; gap:0.5rem;";
                adminInfoDiv.className = 'admin-only';
                adminInfoDiv.innerHTML = `<span>ç®¡ç†å“¡</span><div style="width:24px; height:24px; background:var(--accent-gradient); border-radius:50%; text-align:center; line-height:24px; font-weight:bold;">A</div>`;
                userSectionEl.insertBefore(adminInfoDiv, homeButton);


                const logoutBtn = document.createElement('button');
                logoutBtn.className = 'modern-btn admin-only';
                logoutBtn.textContent = 'ç™»å‡ºç®¡ç†';
                logoutBtn.onclick = adminLogout;
                userSectionEl.appendChild(logoutBtn); // Add to end
            } else if (currentMode === 'read') {
                const toolsButton = document.createElement('button');
                toolsButton.className = 'modern-btn reader-only utility-toggle-btn';
                toolsButton.innerHTML = 'ğŸ› ï¸ å·¥å…·'; // Changed back to "å·¥å…·"
                toolsButton.onclick = () => toggleSidebar('utilitySidebarEl');
                userSectionEl.insertBefore(toolsButton, homeButton);
            }
        }

        // --- Show Info Modal (for About, Editor's Note, Resources) ---
        function showInfoModal(title, content) {
            infoModalTitleEl.textContent = title;
            infoModalBodyEl.textContent = content; // Using textContent for simple text to preserve formatting
            infoModalEl.classList.add('active');
        }

        async function showInfoModalFromFile(title, filePath) {
            try {
                const response = await fetch(filePath);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const content = await response.text();
                showInfoModal(title, content);
            } catch (error) {
                console.error("Error fetching file for modal:", error);
                showInfoModal(title, `ç„¡æ³•è¼‰å…¥å…§å®¹ï¼š${filePath}\néŒ¯èª¤ï¼š${error.message}`);
            }
        }


        // --- Sidebar Rendering ---
        // ... (renderSidebar, setActiveSidebarItem, toggleCategory, toggleSidebar remain largely the same) ...

        // --- Search Function ---
        // ... (searchInputEl listener remains the same) ...

        // --- View Mode (Grid/List) ---
        // In gridViewBtn listener, adjust columns for smaller cards:
        // documentsGridEl.style.gridTemplateColumns = 'repeat(auto-fit, minmax(320px, 1fr))'; // Smaller min width

        // --- Favorites ---
        // ... (toggleFavorite, showFavorites, renderFavoritesList remain largely the same, check button text) ...

        // --- Utility Modals (Report Error / Donate) ---
        // ... (showUtilityModal for report/donate remains largely the same) ...

        // --- Article Form (Add/Edit) ---
        // ... (openArticleFormModal, articleFormEl listener remain largely the same) ...

        // --- Initialization ---
        // ... (loadInitialContent remains largely the same) ...

        // --- Global Functions on window object ---
        // ... (Remove changeTheme from global if it was there) ...

        // --- Initial Call & Event Listeners ---
        // ... (mainTitleElementForAnimation listener, showModeSelectorScreen call, DOMContentLoaded listener, keydown listener, scrollBehavior, dynamicStyle remain largely the same) ...

        // Ensure the dynamic style script for animations is still present at the end.
        // Make sure the main-title animation is correct after removing theme switcher.

    </script>
</body>
</html>